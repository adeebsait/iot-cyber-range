%YAML 1.1
---
default-rule-path: /etc/suricata/rules
rule-files:
  - suricata.rules

#################################################################
# Run Suricata as an unprivileged user once the capture socket #
# is open – matches the user and group already present inside  #
# the Docker image.                                            #
#################################################################
run-as:
  user: suricata
  group: suricata

#################################################################
# Capture settings                                             #
#################################################################
af-packet:
  - interface: ens33
    threads: auto
    defrag: yes
    cluster-id: 99
    cluster-type: cluster_flow
    tpacket-v3: yes

#################################################################
# Outputs                                                      #
#################################################################
outputs:
  - eve-log:
      enabled: yes
      filetype: regular
      filename: /var/log/suricata/eve.json
      types: [alert]

  - stats:
      enabled: yes
      filename: /var/log/suricata/stats.log